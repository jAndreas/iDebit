define(["es5shim","tools"],function(e,t){var n=Object.create(null),r=Object.create(null),i=t.type,s=window,o=s.document,u;return r.emit=function(t){s.setTimeout(function(){var r=0;if(i(t)!=="Object")throw new Error("expected an object");if(typeof t.name!="string")throw new Error("expected an event type as string");t.name in n&&n[t.name].some(function(n,i){try{n.callback.apply(n.scope,[t]),r++}catch(s){throw new Error('unable to dispatch event "'+t.name+'". Original error: "'+s.message+'"')}return t.stopPropagation}),typeof t.callback=="function"&&t.callback(r,t.response)},0)},r.on=function(t,r,s){i(t)!=="Array"&&(t=[t]),t.forEach(function(t){if(typeof t!="string")throw new Error('expected a string value (or an Array of strings), received "'+typeof t+'" instead');typeof n[t]=="undefined"&&(n[t]=[]),typeof r=="function"&&n[t].push({callback:r,scope:s||null})})},r.off=function(t,r){i(t)!=="Array"&&(t=[t]),t.forEach(function(e){if(typeof e!="string")throw new Error("expected a string value (or an Array of strings)");n[e]&&i(n[e])==="Array"&&(r===u?n[e]=[]:n[e]=n[e].filter(function(e){return e.callback!==r}))})},r.once=function(t,n,i){function s(){r.off(t,s),n.apply(this,arguments)}r.on(t,s,i)},r})